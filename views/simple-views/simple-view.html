{% extends "app-layout.html" %}

{% block content %}
<h1>Welcome to {{ subreddit }}</h1>

<form method="POST" action="/app/r/{{ subreddit }}/posts">
  <div class="form-group">
    <label>Titulo</label>
    <input type="text" name="title" class="form-control" placeholder="titulo">
  </div>
  <div class="form-group">
    <label>url</label>
    <input type="text" name="url" class="form-control" placeholder="url">
  </div>
  <button type="submit" class="btn btn-default">Submit</button>
</form>

<div id="posts">
{% for post in posts %}
<div><a href="{{ post.url }}">{{post.title}}</a></div>
{% endfor %}	
</div>


{% endblock %}

{% block js %}
<script type="text/javascript" src="/socket.io/socket.io.js"></script>
<script type="text/javascript">
var socket = io.connect()

socket.on('connect', function () {
	socket.emit('join', {'channel':'{{ subreddit }}'});
});

socket.on('new-post', function(post){
	console.log('New post =>', post)

	$('#posts').append('<div><a href="'+post.url+'">'+post.title+'</a></div')
	//$('#data').text( JSON.stringify(metric.data) )
})
</script>
{% endblock %}
